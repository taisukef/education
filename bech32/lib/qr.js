function QR(){
	if(!document.getElementsByClassName) return;
	var e=document.getElementsByClassName('qrcode');
	for(var i=0;i<e.length;i++){
		QR_main(e[i],e[i].getAttribute('data-str'),e[i].getAttribute('data-mode'),e[i].getAttribute('data-ver'),e[i].getAttribute('data-lv'),e[i].getAttribute('data-mask'),e[i].getAttribute('data-px'));
	}
}
function QR_main(canvas,str,mode,ver,lv,mask,px){
	if(typeof canvas!='object'||!canvas.getContext) return;
	try{
		str=str.toString();
	}catch(e){
		str=str||'';
	}
	if(typeof mode!='number') mode=parseInt(mode);
	if(typeof ver!='number') ver=parseInt(ver);
	if(lv=='M'||lv=='m') lv=0;
	if(lv=='L'||lv=='l') lv=1;
	if(lv=='H'||lv=='h') lv=2;
	if(lv=='Q'||lv=='q') lv=3;
	if(typeof lv!='number') lv=parseInt(lv);
	if(typeof mask!='number') mask=parseInt(mask);
	if(typeof px!='number') px=parseInt(px);
	if(mode!=Math.floor(mode)||mode<0||mode>2) mode=0;
	if(ver!=Math.floor(ver)||ver<1||ver>40) ver=1;
	if(lv!=Math.floor(lv)||lv<0||lv>3) lv=1;
	if(mask!=Math.floor(mask)||mask<0||mask>7) mask=undefined;
	if(px!=px) px=3;
	var spec=[];
	spec[1]=[26,[16,19,9,13],[1,1,1,1]];
	spec[2]=[44,[28,34,16,22],[1,1,1,1]];
	spec[3]=[70,[44,55,26,34],[1,1,2,2]];
	spec[4]=[100,[64,80,36,48],[2,1,4,2]];
	spec[5]=[134,[86,108,46,62],[2,1,4,4]];
	spec[6]=[172,[108,136,60,76],[4,2,4,4]];
	spec[7]=[196,[124,156,66,88],[4,2,5,6]];
	spec[8]=[242,[154,194,86,110],[4,2,6,6]];
	spec[9]=[292,[182,232,100,132],[5,2,8,8]];
	spec[10]=[346,[216,274,122,154],[5,4,8,8]];
	spec[11]=[404,[254,324,140,180],[5,4,11,8]];
	spec[12]=[466,[290,370,158,206],[8,4,11,10]];
	spec[13]=[532,[334,428,180,244],[9,4,16,12]];
	spec[14]=[581,[365,461,197,261],[9,4,16,16]];
	spec[15]=[655,[415,523,223,295],[10,6,18,12]];
	spec[16]=[733,[453,589,253,325],[10,6,16,17]];
	spec[17]=[815,[507,647,283,367],[11,6,19,16]];
	spec[18]=[901,[563,721,313,397],[13,6,21,18]];
	spec[19]=[991,[627,795,341,445],[14,7,25,21]];
	spec[20]=[1085,[669,861,385,485],[16,8,25,20]];
	spec[21]=[1156,[714,932,406,512],[17,8,25,23]];
	spec[22]=[1258,[782,1006,442,568],[17,9,34,23]];
	spec[23]=[1364,[860,1094,464,614],[18,9,30,25]];
	spec[24]=[1474,[914,1174,514,664],[20,10,32,27]];
	spec[25]=[1588,[1000,1276,538,718],[21,12,35,29]];
	spec[26]=[1706,[1062,1370,596,754],[23,12,37,34]];
	spec[27]=[1828,[1128,1468,628,808],[25,12,40,34]];
	spec[28]=[1921,[1193,1531,661,871],[26,13,42,35]];
	spec[29]=[2051,[1267,1631,701,911],[28,14,45,38]];
	spec[30]=[2185,[1373,1735,745,985],[29,15,48,40]];
	spec[31]=[2323,[1455,1843,793,1033],[31,16,51,43]];
	spec[32]=[2465,[1541,1955,845,1115],[33,17,54,45]];
	spec[33]=[2611,[1631,2071,901,1171],[35,18,57,48]];
	spec[34]=[2761,[1725,2191,961,1231],[37,19,60,51]];
	spec[35]=[2876,[1812,2306,986,1286],[38,19,63,53]];
	spec[36]=[3034,[1914,2434,1054,1354],[40,20,66,56]];
	spec[37]=[3196,[1992,2566,1096,1426],[43,21,70,59]];
	spec[38]=[3362,[2102,2702,1142,1502],[45,22,74,62]];
	spec[39]=[3532,[2216,2812,1222,1582],[47,24,77,65]];
	spec[40]=[3706,[2334,2956,1276,1666],[49,25,81,68]];
	var poly=[];
	poly[7]=[0,87,229,146,149,238,102,21];
	poly[10]=[0,251,67,46,61,118,70,64,94,32,45];
	poly[13]=[0,74,152,176,100,86,100,106,104,130,218,206,140,78];
	poly[15]=[0,8,183,61,91,202,37,51,58,58,237,140,124,5,99,105];
	poly[16]=[0,120,104,107,109,102,161,76,3,91,191,147,169,182,194,225,120];
	poly[17]=[0,43,139,206,78,43,239,123,206,214,147,24,99,150,39,243,163,136];
	poly[18]=[0,215,234,158,94,184,97,118,170,79,187,152,148,252,179,5,98,96,153];
	poly[20]=[0,17,60,79,50,61,163,26,187,202,180,221,225,83,239,156,164,212,212,188,190];
	poly[22]=[0,210,171,247,242,93,230,14,109,221,53,200,74,8,172,98,80,219,134,160,105,165,231];
	poly[24]=[0,229,121,135,48,211,117,251,126,159,180,169,152,192,226,228,218,111,0,117,232,87,96,227,21];
	poly[26]=[0,173,125,158,2,103,182,118,17,145,201,111,28,165,53,161,21,245,142,13,102,48,227,153,145,218,70];
	poly[28]=[0,168,223,200,104,224,234,108,180,110,190,195,147,205,27,232,201,21,43,245,87,42,195,212,119,242,37,9,123];
	poly[30]=[0,41,173,145,152,216,31,179,182,50,48,110,86,239,96,222,125,42,173,226,193,224,130,156,37,251,216,238,40,192,180];
	poly[32]=[0,10,6,106,190,249,167,4,67,209,138,138,32,242,123,89,27,120,185,80,156,38,69,171,60,28,222,80,52,254,185,220,241];
	poly[34]=[0,111,77,146,94,26,21,108,19,105,94,113,193,86,140,163,125,58,158,229,239,218,103,56,70,114,61,183,129,167,13,98,62,129,51];
	poly[36]=[0,200,183,98,16,172,31,246,234,60,152,115,0,167,152,113,248,238,107,18,63,218,37,87,210,105,177,120,74,121,196,117,251,113,233,30,120];
	poly[40]=[0,59,116,79,161,252,98,128,205,128,161,247,57,163,56,235,106,53,26,187,174,226,104,170,7,175,35,181,114,88,41,47,163,125,134,72,20,232,53,35,15];
	poly[42]=[0,250,103,221,230,25,18,137,231,0,3,58,242,221,191,110,84,230,8,188,106,96,147,15,131,139,34,101,223,39,101,213,199,237,254,201,123,171,162,194,117,50,96];
	poly[44]=[0,190,7,61,121,71,246,69,55,168,188,89,243,191,25,72,123,9,145,14,247,1,238,44,78,143,62,224,126,118,114,68,163,52,194,217,147,204,169,37,130,113,102,73,181];
	poly[46]=[0,112,94,88,112,253,224,202,115,187,99,89,5,54,113,129,44,58,16,135,216,169,211,36,1,4,96,60,241,73,104,234,8,249,245,119,174,52,25,157,224,43,202,223,19,82,15];
	poly[48]=[0,228,25,196,130,211,146,60,24,251,90,39,102,240,61,178,63,46,123,115,18,221,111,135,160,182,205,107,206,95,150,120,184,91,21,247,156,140,238,191,11,94,227,84,50,163,39,34,108];
	poly[50]=[0,232,125,157,161,164,9,118,46,209,99,203,193,35,3,209,111,195,242,203,225,46,13,32,160,126,209,130,160,242,215,242,75,77,42,189,32,113,65,124,69,228,114,235,175,124,170,215,232,133,205];
	poly[52]=[0,116,50,86,186,50,220,251,89,192,46,86,127,124,19,184,233,151,215,22,14,59,145,37,242,203,134,254,89,190,94,59,65,124,113,100,233,235,121,22,76,86,97,39,242,200,220,101,33,239,254,116,51];
	poly[54]=[0,183,26,201,87,210,221,113,21,46,65,45,50,238,184,249,225,102,58,209,218,109,165,26,95,184,192,52,245,35,254,238,175,172,79,123,25,122,43,120,108,215,80,128,201,235,8,153,59,101,31,198,76,31,156];
	poly[56]=[0,106,120,107,157,164,216,112,116,2,91,248,163,36,201,202,229,6,144,254,155,135,208,170,209,12,139,127,142,182,249,177,174,190,28,10,85,239,184,101,124,152,206,96,23,163,61,27,196,247,151,154,202,207,20,61,10];
	poly[58]=[0,82,116,26,247,66,27,62,107,252,182,200,185,235,55,251,242,210,144,154,237,176,141,192,248,152,249,206,85,253,142,65,165,125,23,24,30,122,240,214,6,129,218,29,145,127,134,206,245,117,29,41,63,159,142,233,125,148,123];
	poly[60]=[0,107,140,26,12,9,141,243,197,226,197,219,45,211,101,219,120,28,181,127,6,100,247,2,205,198,57,115,219,101,109,160,82,37,38,238,49,160,209,121,86,11,124,30,181,84,25,194,87,65,102,190,220,70,27,209,16,89,7,33,240];
	poly[62]=[0,65,202,113,98,71,223,248,118,214,94,0,122,37,23,2,228,58,121,7,105,135,78,243,118,70,76,223,89,72,50,70,111,194,17,212,126,181,35,221,117,235,11,229,149,147,123,213,40,115,6,200,100,26,246,182,218,127,215,36,186,110,106];
	poly[64]=[0,45,51,175,9,7,158,159,49,68,119,92,123,177,204,187,254,200,78,141,149,119,26,127,53,160,93,199,212,29,24,145,156,208,150,218,209,4,216,91,47,184,146,47,140,195,195,125,242,238,63,99,108,140,230,242,31,204,11,178,243,217,156,213,231];
	poly[66]=[0,5,118,222,180,136,136,162,51,46,117,13,215,81,17,139,247,197,171,95,173,65,137,178,68,111,95,101,41,72,214,169,197,95,7,44,154,77,111,236,40,121,143,63,87,80,253,240,126,217,77,34,232,106,50,168,82,76,146,67,106,171,25,132,93,45,105];
	poly[68]=[0,247,159,223,33,224,93,77,70,90,160,32,254,43,150,84,101,190,205,133,52,60,202,165,220,203,151,93,84,15,84,253,173,160,89,227,52,199,97,95,231,52,177,41,125,137,241,166,225,118,2,54,32,82,215,175,198,43,238,235,27,101,184,127,3,5,8,163,238];
	var char0=['0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z',' ','$','%','*','+','-','.','/',':'];
	var char1=[];
	for(var i=0;i<45;i++){
		char1[char0[i]]=i;
	}
	var gf0=[1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,1];
	var gf1=[];
	for(var i=0;i<256;i++){
		gf1[gf0[i]]=i;
	}
	if(mode==0) mode=str.match(/[^0-9]/)?1:0;
	if(mode==1) mode=str.match(/[^0-9a-z $%*+\-\.\/:]/i)?2:1;
	if(mode==1) str=str.toUpperCase();
	var l;
	if(ver<10){
		l=10-mode;
	}else if(ver<27){
		l=mode!=2?12-mode:16;
	}else{
		l=mode!=2?14-mode:16;
	}
	var len=byte=encodeURIComponent(str).replace(/%../g,'1').length;
	var max;
	for(var i=ver;i<41;i++){
		var b=spec[i][1][lv]*8-l-4;
		if(!mode){
			max=Math.floor(b/10)*3;
			if(b%10>3){
				max++;
				if(b%10>6) max++;
			}
		}else if(mode==1){
			max=Math.floor(b/11)*2;
			if(b%11>5) max++;
		}else{
			max=Math.floor(b/8);
		}
		if(len<=max) break;
		ver++;
		if(ver==10) l=mode!=2?12-mode:16;
		if(ver==27) l=mode!=2?14-mode:16;
	}
	if(ver>40){
		str='str too long.';
		ver=1;
		lv=1;
		l=8;
		mode=2;
	}
	var data=(1<<mode)<<l|len;
	data=data.toString(2);
	while(data.length<l+4){data='0'+data;}
	var c;
	if(!mode){
		for(var i=0;i<len;i+=3){
			c=parseInt(str.substr(i,3)).toString(2);
			while(c.length<10){c='0'+c;}
			if(i+2==len) c=c.substr(3);
			if(i+1==len) c=c.substr(6);
			data+=c;
		}
	}else if(mode==1){
		for(var i=0;i<len;i+=2){
			if(i+1==len){
				c=char1[str.substr(i,1)].toString(2);
				while(c.length<6){c='0'+c;}
				data+=c;
			}else{
				c=(char1[str.substr(i,1)]*45+char1[str.substr(i+1,1)]).toString(2);
				while(c.length<11){c='0'+c;}
				data+=c;
			}
		}
	}else{
		var u=encodeURIComponent(str);
		for(var i=0;i<u.length;i++){
			c=u.substr(i,1);
			if(c=='%'){
				c=parseInt(u.substr(i+1,2),16).toString(2);
				i+=2;
			}else{
				c=c.charCodeAt().toString(2);
			}
			while(c.length<8){c='0'+c;}
			data+=c;
		}
	}
	if(data.length>spec[ver][1][lv]*8-4){
		while(data.length<spec[ver][1][lv]*8){
			data+='0';
		}
	}else{
		data+='0000';
	}
	while(data.length%8){data+='0';}
	var tmp=[];
	for(var i=0;i<data.length;i+=8){
		tmp.push(parseInt(data.substr(i,8),2));
	}
	while(tmp.length<spec[ver][1][lv]){
		tmp.push(236);
		if(tmp.length<spec[ver][1][lv]) tmp.push(17);
	}
	var db=[];
	var eb=[];
	for(var i=0;i<spec[ver][2][lv];i++){
		var rs=[];
		rs[0]=Math.floor(spec[ver][0]/spec[ver][2][lv]);
		rs[1]=Math.floor(spec[ver][1][lv]/spec[ver][2][lv]);
		if(spec[ver][2][lv]-i<=spec[ver][0]%spec[ver][2][lv]){
			rs[0]++;
			rs[1]++;
		}
		rs[2]=rs[0]-rs[1];
		db[i]=[];
		for(var j=0;j<rs[1];j++){
			db[i].push(tmp.shift());
		}
		eb[i]=db[i].concat();
		var gx=[];
		for(var j=0;j<rs[1];j++){
			for(k=0;k<=rs[2];k++){
				gx[k]=poly[rs[2]][k]+gf1[eb[i][0]];
				if(gx[k]>255) gx[k]-=255;
			}
			for(k=0;k<=rs[2];k++){
				eb[i][k]=eb[i][k]^gf0[gx[k]];
			}
			eb[i].shift();
		}
	}
	data=[];
	while(data.length<spec[ver][1][lv]){
		for(var i=0;i<spec[ver][2][lv];i++){
			if(db[i][0]!=undefined) data.push(db[i].shift());
		}
	}
	while(data.length<spec[ver][0]){
		for(var i=0;i<spec[ver][2][lv];i++){
			if(eb[i][0]!=undefined) data.push(eb[i].shift());
		}
	}
	var w=ver*4+17;
	var fix=[];
	for(var i=0;i<w;i++){
		fix[i]=[];
		fix[i][w-1]=undefined;
		if(i<7 || i>w-8){
			fix[i].splice(0,9,1,1,1,1,1,1,1,0,2);
			if(i<7) fix[i].splice(w-8,8,0,1,1,1,1,1,1,1);
			if((i>0&&i<6)||(i>w-7&&i<w-1)){
				fix[i].splice(1,5,0,0,0,0,0);
				if(i<7) fix[i].splice(w-6,5,0,0,0,0,0);
				if((i>1&&i<5)||(i>w-6&&i<w-2)){
					fix[i].splice(2,3,1,1,1);
					if(i<7) fix[i].splice(w-5,3,1,1,1);
				}
			}
		}
		if(i==7){
			fix[i].splice(0,9,0,0,0,0,0,0,0,0,2);
			fix[i].splice(w-8,8,0,0,0,0,0,0,0,0);
		}
		if(i==8){
			fix[i].splice(0,9,2,2,2,2,2,2,1,2,2);
			fix[i].splice(w-8,8,2,2,2,2,2,2,2,2);
		}
		if(i==w-8) fix[i].splice(0,9,0,0,0,0,0,0,0,0,1);
	}
	if(ver>1){
		var pt=[6,ver*4+10];
		var sp=1+Math.floor(ver/7);
		if(sp>1){
			var c=Math.round((pt[1]-pt[0])/sp);
			if(c%2) c++;
			for(var i=1;i<sp;i++){
				pt.splice(1,0,pt[1]-c);
			}
		}
		for(var i=0;i<pt.length;i++){
			for(var j=0;j<pt.length;j++){
				if(fix[pt[i]][pt[j]]==undefined){
					for(var k=-2;k<3;k++){
						fix[pt[i]+k].splice(pt[j]-2,5,1,1,1,1,1);
						if(k>-2&&k<2){
							fix[pt[i]+k].splice(pt[j]-1,3,0,0,0);
							if(!k) fix[pt[i]].splice(pt[j],1,1);
						}
					}
				}
			}
		}
	}
	for(var i=8;i<w-8;i++){
			fix[6][i]=!(i%2);
			fix[i][6]=!(i%2);
	}
	if(ver>6){
		var d=ver<<12;
		var g=d;
		for(var i=5;i>=0;i--){
			if((1<<i+12)>g) continue;
			g^=7973<<(i);
		}
		d=d+g;
		for(var i=0;i<6;i++){
			for(var j=0;j<3;j++){
				var b=1<<(i*3+j)&d?1:0;
				fix[w-11+j][i]=b;
				fix[i][w-11+j]=b;
			}
		}
	}
	var code=[];
	var tes=[];
	for(var i=0;i<8;i++){
		code[i]=[];
		for(var j=0;j<w;j++){
			code[i][j]=fix[j].concat();
		}
		var d=(lv<<3|i)<<10;
		var g=d;
		for(var j=14;j>9;j--){
			if((1<<j)>g) continue;
			g^=1335<<(j-10);
		}
		d=d+g^21522;
		for(var j=0;j<15;j++){
			var b=d&(1<<j)?1:0;
			for(var k=j;1;k++){
				if(code[i][k][8]==2){
					code[i][k][8]=b;
					break;
				}
			}
			for(var k=j+1;1;k++){
				if(code[i][8][w-k]==2){
					code[i][8][w-k]=b;
					break;
				}
			}
		}
	}
	var y=w-1;
	var x=w-1;
	var d=0;
	var byte,bit;
	for(var i=0;x>0;i++){
		byte=data[i]||0;
		for(var j=0;j<8;){
			if(code[0][y][x]==undefined){
				bit=byte&(1<<7-j)?1:0;
				code[0][y][x]=(y+x)%2==0?bit^1:bit;
				code[1][y][x]=y%2==0?bit^1:bit;
				code[2][y][x]=x%3==0?bit^1:bit;
				code[3][y][x]=(y+x)%3==0?bit^1:bit;
				code[4][y][x]=(Math.floor(y/2)+Math.floor(x/3))%2==0?bit^1:bit;
				code[5][y][x]=(y*x)%2+(y*x)%3==0?bit^1:bit;
				code[6][y][x]=((y*x)%2+(y*x)%3)%2==0?bit^1:bit;
				code[7][y][x]=((y*x)%3+(y+x)%2)%2==0?bit^1:bit;
				j++;
				if(j==8) break;
			}
			if(code[0][y][x-1]==undefined){
				bit=byte&(1<<7-j)?1:0;
				code[0][y][x-1]=(y+(x-1))%2==0?bit^1:bit;
				code[1][y][x-1]=y%2==0?bit^1:bit;
				code[2][y][x-1]=(x-1)%3==0?bit^1:bit;
				code[3][y][x-1]=(y+(x-1))%3==0?bit^1:bit;
				code[4][y][x-1]=(Math.floor(y/2)+Math.floor((x-1)/3))%2==0?bit^1:bit;
				code[5][y][x-1]=(y*(x-1))%2+(y*(x-1))%3==0?bit^1:bit;
				code[6][y][x-1]=((y*(x-1))%2+(y*(x-1))%3)%2==0?bit^1:bit;
				code[7][y][x-1]=((y*(x-1))%3+(y+(x-1))%2)%2==0?bit^1:bit;
				j++;
			}
			if(!d){
				if(y==0){
					d=1;
					x-=2;
					if(x==6) x--;
				}else{
					y--;
				}
			}else{
				if(y==w-1){
					d=0;
					x-=2;
					if(x==6) x--;
				}else{
					y++;
				}
			}
		}
	}
	if(mask==undefined){
		var pt=[];
		for(var k=0;k<8;k++){
			pt[k]=0;
			var b=0;
			for(var i=0;i<w;i++){
				for(var j=0;j<w;j++){
					var t=code[k][i][j];
					if(t) b++;
					if(i>3&&(i==w-1||t!=code[k][i+1][j])&&t==code[k][i-1][j]&&t==code[k][i-2][j]&&t==code[k][i-3][j]&&t==code[k][i-4][j]){
						pt[k]+=3;
						for(var l=i-5;l>=0;l--){
							if(t==code[k][l][j]) pt[k]++;
						}
					}
					if(j>3&&t!=code[k][i][j+1]&&t==code[k][i][j-1]&&t==code[k][i][j-2]&&t==code[k][i][j-3]&&t==code[k][i][j-4]){
						pt[k]+=3;
						for(var l=j-5;l>=0;l--){
							if(t==code[k][i][l]) pt[k]++;
						}
					}
					if(i>0&&j>0&&t==code[k][i-1][j]&&t==code[k][i][j-1]&&t==code[k][i-1][j-1]){
						pt[k]+=3;
					}
					if(t){
						if(i>2&&i<w-3&&code[k][i-1][j]==1&&code[k][i+1][j]==1&&code[k][i-2][j]==0&&code[k][i+2][j]==0&&code[k][i-3][j]==1&&code[k][i+3][j]==1){
							if(i>6&&code[k][i-4][j]==0&&code[k][i-5][j]==0&&code[k][i-6][j]==0&&code[k][i-7][j]==0){
								pt[k]+=40;
							}else if(i<w-7&&code[k][i+4][j]==0&&code[k][i+5][j]==0&&code[k][i+6][j]==0&&code[k][i+7][j]==0){
								pt[k]+=40;
							}
						}
						if(j>2&&j<w-3&&code[k][i][j-1]==1&&code[k][i][j+1]==1&&code[k][i][j-2]==0&&code[k][i][j+2]==0&&code[k][i][j-3]==1&&code[k][i][j+3]==1){
							if(j>6&&code[k][i][j-4]==0&&code[k][i][j-5]==0&&code[k][i][j-6]==0&&code[k][i][j-7]==0){
								pt[k]+=40;
							}else if(j<w-7&&code[k][i][j+4]==0&&code[k][i][j+5]==0&&code[k][i][j+6]==0&&code[k][i][j+7]==0){
								pt[k]+=40;
							}
						}
					}
				}
			}
			b=Math.abs(b/w/w*100)-50;
			for(var i=5;i<b;i+=5){
				pt[k]+=10;
			}
		}
		mask=0;
		for(var i=1;i<8;i++){
			if(pt[i]<pt[mask]) mask=i;
		}
	}
	canvas.width=(w+8)*px;
	canvas.height=(w+8)*px;
	var ctx=canvas.getContext("2d");
	ctx.fillStyle="white";
	ctx.fillRect(0,0,canvas.width,canvas.height);
	ctx.fillStyle="black";
	for(var i=0;i<w;i++){
		for(var j=0;j<w;j++){
			if(code[mask][i][j]==1) ctx.fillRect(j*px+4*px,i*px+4*px,px,px);
		}
	}
	return([canvas,str,mode,ver,lv,mask,px]);
}
